<script type="text/javascript">

    // HANDLE ENABLE/DISABLE
    function handleEnableDisable(productId) {
        var currentValue = parseInt($(`#id_qty_${productId}`).val());
        var minusDisable = currentValue < 2;
        var plusDisable = currentValue > 98;
        $(`#decrement-qty_${productId}`).prop('disabled', minusDisable);
        $(`#increment-qty_${productId}`).prop('disabled', minusDisable);
    }

    // PROPER ENABLING/DISABLING OF ALL INPUT ON PAGE LOAD
    var allQtyInput = $('.qty_input');
    for(var i = 0; i < allQtyInput.length; i++){
        var productId = $(allQtyInput[i]).data('productId');
        handleEnableDisable(productId);
    }

    // CHECK ENABLE DISABLE EVERY TIME INPUT CHANGES
    $('.qty_input').change(function() {
        var productId = $(this).data('product_id');
        handleEnableDisable(productId)
    });

    // INCREMENT QTY
    $('.increment_qty').click(function(e) {
        e.preventDefault();
        var closestInput = $(this).closest('.input-group').find('qty_input')[0];
        var currentValue = parseInt($(closestInput).val());
        $(closestInput).val(currentValue + 1);
        var productId = $(this).data('product_id');
        handleEnableDisable(productId);
    });

    // DECREMENT QTY
    $('.decrement_qty').click(function(e) {
        e.preventDefault();
        var closestInput = $(this).closest('.input-group').find('qty_input')[0];
        var currentValue = parseInt($(closestInput).val());
        $(closestInput).val(currentValue - 1);
        var productId = $(this).data('product_id');
        handleEnableDisable(productId);
    });

    // UPDATE FORM
    $('.update-link').click(function(e) {
        var form = $(this).prev('.update-form');
        form.submit();
    });

    // REMOVE
    $('.remove-link').click(function(e) {
        var csrfToken = "{{ csrf_token }}";
        var productId = $(this).attr('id').split('remove_')[1];
        var url = `/cart/remove/${productId}/`;
        var data = {'Csrfmiddlewaretoken': csrfToken };

        $.post(url, data)
         .done(function() {
            location.reload();
    });
    })

    console.log('im here')
</script>